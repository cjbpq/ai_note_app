# 🗺️ 智慧笔记 App 开发路线图 (Roadmap)

这份路线图基于当前“前端 UI 基本完成、后端 API 基础就绪”的状态，结合校园网络环境、新手开发者背景以及 Expo 技术栈特性制定。

## 📅 阶段一：核心链路联调与防御性构建 (Integration & Stability)

**目标**：确保“通过”路径（Happy Path）完全打通，不再依赖 Mock 数据，应用在模拟器上能稳定运行。

- [ ] **全链路接口对接**
  - [ ] **鉴权闭环**：实现 Login -> JWT 存储 -> 请求拦截器注入 Token -> 401 Token 过期自动登出/刷新机制。
  - [x] **上传链路**：打通 拍照/选图 -> FormData 封装 -> 后端上传接口 -> 获取图片 URL 回显。
  - [x] **笔记 CRUD**：确保 增、删、改、查 均对接真实后端数据库。
- [ ] **数据一致性校验**
  - [x] 对照后端 Swagger/接口文档，更新 `types/index.ts`。 (**备注**:后续需要清理一下types文件，重新审查一遍，清理垃圾)
  - [ ] **防御性编程**：后端返回 `null` 或字段缺失时，前端 UI 不应白屏（使用 Optional Chaining `?.` 和空值合并 `??`）。
- [ ] **基础错误处理**
  - [ ] 全局 Toast 提示：网络错误、服务器错误统一弹窗。
  - [ ] 表单验证：登录、提交笔记前的非空校验。

## 📱 阶段二：真机适配与离线优先 (Native & Offline)

**目标**：从模拟器走向真机，解决“校园网信号差”和“原生兼容性”问题。- 

- [ ] **EAS Build 环境搭建**
  - [ ] 配置 `eas.json` (Development Profile)。
  - [ ] 打包 Android APK (开发版) 安装到真机进行调试（特别是 SQLite 和 相机功能）。
- [ ] **离线能力 (Offline First)**
  - [ ] **TanStack Query 缓存策略**：配置 `staleTime` 和 `gcTime`，确保断网也能看到上次加载的列表。
  - [ ] **SQLite 本地降级**：当无网络时，笔记内容优先从 SQLite 本地库读取。
- [ ] **原生体验优化**
  - [ ] **安全区适配**：检查刘海屏、灵动岛遮挡 (`SafeAreaView`)。
  - [ ] **权限管理**：优雅地请求相机、相册权限（如果被拒绝，引导用户去设置页打开）。
  - [ ] **Android 物理返回键**：处理 Android 侧滑返回和硬件返回键逻辑。

## 🤖 阶段三：AI 能力深度集成与体验升级 (AI & UX)

**目标**：对接后端扩展功能，提升“智慧”属性，优化因为 AI 延迟带来的等待体验。

- [ ] **AI 扩展功能**
  - [ ] **OCR/图像识别**：对接后端 OCR 接口，将图片转文字。
  - [ ] **智能分类/标签**：展示后端 AI 分析出的标签。
- [ ] **交互体验优化 (UX)**
  - [ ] **骨架屏 (Skeleton)**：列表加载时显示骨架屏代替 loading 转圈。
  - [ ] **乐观更新 (Optimistic UI)**：点赞、修改标题等操作，先在 UI 上变，再发请求，失败则回滚。
  - [ ] **长列表性能**：使用 `FlashList` 替换 `FlatList` (如果列表很长)。
  - [ ] **图片优化**：使用 `expo-image` 替代 React Native 原生 Image，处理缓存和渐进式加载。

## 🚀 阶段四：分发、监控与运维 (Release & Ops)

**目标**：准备小范围内测，建立报错反馈机制。

- [ ] **分发准备**
  - [ ] 修改 App 图标 (`icon.png`) 和启动图 (`splash.png`)。
  - [ ] 配置 `app.json` 中的版本号和 Bundle ID。
- [ ] **热更新 (OTA)**
  - [ ] 配置 `expo-updates`，实现不发新包即可修复 JS 层 Bug。
- [ ] **错误监控**
  - [ ] 集成 **Sentry**，捕获真机上的 Crash 和 JS 报错（这对新手排查线上问题至关重要）。

---

### 💡 给开发者的建议 (Tips)

1.  **关于后端协作**：由简入繁。先别急着接 AI 接口，先把简单的“增删改查”跑通，确认 Token 机制没问题。
2.  **关于环境**：尽早把 App 装到真机上。模拟器永远无法模拟真实的摄像头体验和糟糕的 4G/校园网信号。
3.  **关于代码**：不要在一个组件里写几百行。如果 `[id].tsx` 超过 200 行，考虑把部分 UI 拆成 `components/` 下的小组件。
