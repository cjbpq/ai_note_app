---
name: update-devlog
description: 在开发结束后将 TODO 中已完成事项整理进 DEV_LOG，并将完成项详细归档到 History，支持按“今日”或“多日区间”批量处理
---

# update-devlog

## 1) 这个 Skill 解决什么问题

在一天（或连续几天）开发结束后，自动完成三件事：

1. 从 `LOG/TODO.md` 提取本次完成事项；
2. 按项目既有风格写入 `LOG/DEV_LOG.md`（可读总结 + 决策信息）；
3. 将完成项细节归档到 `LOG/History.md`（尽量原文保留，便于追踪）。

目标：减少手工整理成本，同时避免遗漏关键信息。

---

## 2) 触发条件

当用户出现以下意图时应自动启用本 Skill：

- “整理今天开发日志 / 收尾 / 写日报”
- “把 TODO 同步到 DEV_LOG”
- “把完成项归档到 History”
- “按最近几天整理进度”

---

## 3) 输入与默认策略

### 可选输入

- 时间范围：`今日` / `近N天` / `YYYY-MM-DD ~ YYYY-MM-DD`
- 目标模块：可选（如 Note/Auth/Scan）

### 默认策略（无明确输入时）

- 默认范围：`今日`。
- 若 TODO 完成项未标日期：按“最近一次会话新增完成项”处理。

---

## 4) 执行流程（严格顺序）

1. **读取数据源**
   - `LOG/TODO.md`
   - `LOG/DEV_LOG.md`
   - `LOG/History.md`

2. **提取候选完成项**
   - 提取 `[x]` 项及其子级描述。
   - 优先识别带 `✅ YYYY-MM-DD` 的条目。
   - 若是“多日整理”，按日期范围筛选。

3. **去重检查（必须）**
   - 在 DEV_LOG/History 中按“标题 + 日期”查重。
   - 已存在则跳过，避免重复归档。

4. **写入 DEV_LOG（总结视角）**
   - 使用既有风格：`## 📅 日期 | 标题`。
   - 内容要点：
     - 本次目标与结果
     - 关键决策（为什么这么做）
     - 架构落点（UI/Hooks/Services/Store）
     - 兼容性结论（Android/iOS）
     - 后续迭代点

5. **写入 History（归档视角）**
   - 以“尽量原封不动”原则记录完成项细节。
   - 若 TODO 条目已有多级子项，优先原样搬运。
   - 保留日期、文件位置、关键说明。

6. **回写 TODO（防堆积）**
   - 已归档完成项从活动区域移除或标记“已归档到 History”。
   - 保留必要索引信息，避免 TODO 过长。

---

## 5) 输出标准

每次执行后需满足：

- `DEV_LOG`：可读摘要完整、风格与历史一致。
- `History`：细节完整可追溯，优先保留原文。
- `TODO`：不重复堆积，完成项状态清晰。
- 明确提示本次处理范围（今日/多日）与条目数量。

---

## 6) 质量约束（必须遵守）

- 不得丢失关键信息（决策/架构落点/兼容性/后续事项）。
- 不得把未完成 `[ ]` 项写入 DEV_LOG/History。
- 不得重复归档同一条目。
- 不得改写任务原意（可精简措辞，但语义必须一致）。

---

## 7) 推荐写作模板

### DEV_LOG 推荐结构

- `## 📅 YYYY-MM-DD | 本次主题`
- 一段总述（1-2 句）
- `### 1. 功能与交付`
- `### 2. 关键决策`
- `### 3. 架构落点`
- `### 4. 兼容性与风险`
- `### 5. 后续 TODO`

### History 推荐结构

- 按 Phase 或日期分组。
- 每条任务保留：原任务名 + 完成日期 + 关键子项（尽量原文）。

---

## 8) 用户可直接使用的触发口令

- “按 update-devlog 整理今天开发记录，并同步 TODO→DEV_LOG→History。”
- “按 update-devlog 整理最近 3 天，去重后归档。”
- “按 update-devlog 只整理 Note 模块，本次完成项自动归档到 History。”

---

## 9) 异常处理规则

- 若时间范围不明确：默认“今日”，并在结果中声明该默认值。
- 若 TODO 无新增完成项：仅输出“本次无可归档条目”，不改动文件。
- 若发现 History/DEV_LOG 同名重复：保留首次记录，跳过重复项并在结果中说明。
